[{"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\index.js":"1","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\App.js":"2","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\reportWebVitals.js":"3","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\pages\\PaymentPage.js":"4","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\utils\\payment-utils.js":"5","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\shared\\AlertComponent.js":"6"},{"size":517,"mtime":1612607525530,"results":"7","hashOfConfig":"8"},{"size":389,"mtime":1612607525529,"results":"9","hashOfConfig":"8"},{"size":375,"mtime":1612607525532,"results":"10","hashOfConfig":"8"},{"size":6231,"mtime":1612698928574,"results":"11","hashOfConfig":"8"},{"size":1530,"mtime":1612607525535,"results":"12","hashOfConfig":"8"},{"size":443,"mtime":1612607525533,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},"1g2gk1t",{"filePath":"17","messages":"18","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"19","messages":"20","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"21","messages":"22","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"23","usedDeprecatedRules":"16"},{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\index.js",[],["28","29"],"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\App.js",[],"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\reportWebVitals.js",[],"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\pages\\PaymentPage.js",["30","31","32"],"import React, { useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport Card from 'react-credit-cards';\r\n\r\nimport Spinner from 'react-bootstrap/Spinner';\r\nimport Container from 'react-bootstrap/Container';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\n\r\nimport { formatCreditCardNumber, formatCVC, formatExpirationDate } from '../utils/payment-utils.js';\r\nimport 'react-credit-cards/es/styles-compiled.css';\r\nimport axios from 'axios';\r\nimport AlertComponent from '../shared/AlertComponent.js';\r\n\r\nfunction PaymentPage() {\r\n\tconst [creditCard, setCreditCard] = useState({\r\n\t\tnumber: '',\r\n\t\tname: '',\r\n\t\texpiry: '',\r\n\t\tcvc: '',\r\n\t\tfocused: '',\r\n\t});\r\n\tconst [alert, setAlert] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst location = useLocation();\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log(location);\r\n\t}, []);\r\n\r\n\tconst handleInputFocus = ({ target }) => {\r\n\t\tsetCreditCard({\r\n\t\t\t...creditCard,\r\n\t\t\tfocused: target.name,\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleInputChange = ({ target }) => {\r\n\t\tif (target.name === 'number') {\r\n\t\t\ttarget.value = formatCreditCardNumber(target.value);\r\n\t\t} else if (target.name === 'expiry') {\r\n\t\t\ttarget.value = formatExpirationDate(target.value);\r\n\t\t} else if (target.name === 'cvc') {\r\n\t\t\ttarget.value = formatCVC(target.value);\r\n\t\t}\r\n\r\n\t\tsetCreditCard({ ...creditCard, [target.name]: target.value });\r\n\t};\r\n\r\n\tconst handleSubmit = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tsetIsLoading(true);\r\n\t\tconst dto = {\r\n\t\t\tpanNumber: creditCard.number.replaceAll(' ', ''),\r\n\t\t\tcardHolderName: creditCard.name,\r\n\t\t\texpiratoryDate: creditCard.expiry,\r\n\t\t\tsecurityCode: creditCard.cvc,\r\n\t\t};\r\n\t\tconsole.log(dto);\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await axios.put(\r\n\t\t\t\t`${process.env.REACT_APP_BANK_API}/payment/invoice${location.pathname.substring(\r\n\t\t\t\t\tlocation.pathname.lastIndexOf('/')\r\n\t\t\t\t)}`,\r\n\t\t\t\tdto\r\n\t\t\t);\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.log(res);\r\n\t\t\topenInNewTab(res.data.redirectUrl);\r\n\t\t} catch (ex) {\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(ex.response);\r\n\r\n\t\t\t// DTO Constraint violation\r\n\t\t\tif (ex.response.data.violations) {\r\n\t\t\t\tsetAlert({\r\n\t\t\t\t\theading: 'Invalid credit card information',\r\n\t\t\t\t\tviolations: ex.response.data.violations,\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Entity not found violation\r\n\t\t\tif (ex.response.status === 404 && ex.response.data) {\r\n\t\t\t\tif (ex.response.data == 'Invoice not found')\r\n\t\t\t\t\tsetAlert({\r\n\t\t\t\t\t\theading: 'Did you get here from a valid referral link?',\r\n\t\t\t\t\t\tviolations: [{ message: ex.response.data }],\r\n\t\t\t\t\t});\r\n\t\t\t\telse\r\n\t\t\t\t\tsetAlert({\r\n\t\t\t\t\t\theading: \"We can't find any such account. Double check all your info.\",\r\n\t\t\t\t\t\tviolations: [{ message: ex.response.data }],\r\n\t\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\tif (ex.response.status === 400) {\r\n\t\t\t\tif (ex.response.data == 'Invoice already paid') {\r\n\t\t\t\t\tsetAlert({\r\n\t\t\t\t\t\theading: 'Did you get here from a valid referral link?',\r\n\t\t\t\t\t\tviolations: [{ message: ex.response.data }],\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetAlert({\r\n\t\t\t\t\theading: 'We found your account, but there have been some errors:',\r\n\t\t\t\t\tviolations: [{ message: ex.response.data }],\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst openInNewTab = (url) => {\r\n\t\tconsole.log('here');\r\n\t\tconst newWindow = window.open(url, '_blank', 'noopener,noreferrer');\r\n\t\tif (newWindow) newWindow.opener = null;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Container>\r\n\t\t\t\t{isLoading && (\r\n\t\t\t\t\t<Row style={{ marginTop: 20 }}>\r\n\t\t\t\t\t\t<Col className=\"text-center\" style={{ marginTop: 80 }} md={{ span: 6, offset: 3 }}>\r\n\t\t\t\t\t\t\t<Spinner\r\n\t\t\t\t\t\t\t\tanimation=\"border\"\r\n\t\t\t\t\t\t\t\tstyle={{ height: 500, width: 500 }}\r\n\t\t\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\t\t\trole=\"status\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t\t\t\t</Spinner>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t)}\r\n\t\t\t\t{!isLoading && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<Row style={{ marginTop: 20 }}>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t{alert && <AlertComponent alert={alert} setAlert={setAlert} />}\r\n\t\t\t\t\t\t\t\t<div id=\"card-wrapper\">\r\n\t\t\t\t\t\t\t\t\t<div key=\"Payment\">\r\n\t\t\t\t\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\t\t\t\t\tnumber={creditCard.number}\r\n\t\t\t\t\t\t\t\t\t\t\tname={creditCard.name}\r\n\t\t\t\t\t\t\t\t\t\t\texpiry={creditCard.expiry}\r\n\t\t\t\t\t\t\t\t\t\t\tcvc={creditCard.cvc}\r\n\t\t\t\t\t\t\t\t\t\t\tfocused={creditCard.focused}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t<Row style={{ marginTop: 15 }}>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"form-group\">\r\n\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"tel\"\r\n\t\t\t\t\t\t\t\t\t\t\tname=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Card Number\"\r\n\t\t\t\t\t\t\t\t\t\t\tpattern=\"\\d{4} \\d{4} \\d{4} \\d{4}\"\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\tonFocus={handleInputFocus}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"form-group\">\r\n\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tname=\"name\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Name\"\r\n\t\t\t\t\t\t\t\t\t\t\tpattern=\"([a-zA-Z ])+\"\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\tonFocus={handleInputFocus}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"tel\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"expiry\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Valid Thru\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tpattern=\"(0[1-9]|1[0-2])\\/[0-9]{2}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonFocus={handleInputFocus}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"tel\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"cvc\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"CVC\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tpattern=\"\\d{3,4}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonFocus={handleInputFocus}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"issuer\" value={creditCard.issuer} />\r\n\t\t\t\t\t\t\t\t\t<div className=\"form-actions\" style={{ marginTop: 15 }}>\r\n\t\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary btn-block\">Pay</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</Container>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default PaymentPage;\r\n","C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\utils\\payment-utils.js",[],"C:\\Projects\\FTN\\Master\\Literarno-udruzenje\\KP\\bank2-frontend\\src\\shared\\AlertComponent.js",[],{"ruleId":"33","replacedBy":"34"},{"ruleId":"35","replacedBy":"36"},{"ruleId":"37","severity":1,"message":"38","line":29,"column":5,"nodeType":"39","endLine":29,"endColumn":7,"suggestions":"40"},{"ruleId":"41","severity":1,"message":"42","line":86,"column":26,"nodeType":"43","messageId":"44","endLine":86,"endColumn":28},{"ruleId":"41","severity":1,"message":"42","line":101,"column":26,"nodeType":"43","messageId":"44","endLine":101,"endColumn":28},"no-native-reassign",["45"],"no-negated-in-lhs",["46"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'location'. Either include it or remove the dependency array.","ArrayExpression",["47"],"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","no-global-assign","no-unsafe-negation",{"desc":"48","fix":"49"},"Update the dependencies array to be: [location]",{"range":"50","text":"51"},[905,907],"[location]"]